<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function exports the result from resolve() to an Apptainer/Singularity definition file. For R version &amp;gt;= 3.1.0, the file is based on the versioned Rocker Docker image.
For R version &amp;lt; 3.1.0, the Apptainer/Singularity definition is based on Debian and it compiles R from source."><title>Create an Apptainer/Singularity Definition File of The Resolved Result — apptainerize • rang</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/JetBrains_Mono-0.4.8/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.8/font.css" rel="stylesheet"><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create an Apptainer/Singularity Definition File of The Resolved Result — apptainerize"><meta property="og:description" content="This function exports the result from resolve() to an Apptainer/Singularity definition file. For R version &amp;gt;= 3.1.0, the file is based on the versioned Rocker Docker image.
For R version &amp;lt; 3.1.0, the Apptainer/Singularity definition is based on Debian and it compiles R from source."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rang</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/compendium.html">Create research compendia</a>
    <a class="dropdown-item" href="../articles/faq.html">FAQ</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/gesistsa/rang/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Create an Apptainer/Singularity Definition File of The Resolved Result</h1>
      <small class="dont-index">Source: <a href="https://github.com/gesistsa/rang/blob/HEAD/R/installation.R" class="external-link"><code>R/installation.R</code></a></small>
      <div class="d-none name"><code>apptainerize.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function exports the result from <code><a href="resolve.html">resolve()</a></code> to an Apptainer/Singularity definition file. For R version &gt;= 3.1.0, the file is based on the versioned Rocker Docker image.
For R version &lt; 3.1.0, the Apptainer/Singularity definition is based on Debian and it compiles R from source.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">apptainerize</span><span class="op">(</span></span>
<span>  <span class="va">rang</span>,</span>
<span>  <span class="va">output_dir</span>,</span>
<span>  materials_dir <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  post_installation_steps <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  image <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r-ver"</span>, <span class="st">"rstudio"</span>, <span class="st">"tidyverse"</span>, <span class="st">"verse"</span>, <span class="st">"geospatial"</span><span class="op">)</span>,</span>
<span>  rang_as_comment <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  lib <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  cran_mirror <span class="op">=</span> <span class="st">"https://cran.r-project.org/"</span>,</span>
<span>  check_cran_mirror <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  bioc_mirror <span class="op">=</span> <span class="st">"https://bioconductor.org/packages/"</span>,</span>
<span>  no_rocker <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  debian_version <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"lenny"</span>, <span class="st">"squeeze"</span>, <span class="st">"wheezy"</span>, <span class="st">"jessie"</span>, <span class="st">"stretch"</span><span class="op">)</span>,</span>
<span>  skip_r17 <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  insert_readme <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  copy_all <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"auto"</span>, <span class="st">"evercran"</span>, <span class="st">"rocker"</span>, <span class="st">"debian"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">apptainerize_rang</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">apptainerise</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">apptainerise_rang</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">singularize</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">singularize_rang</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">singularise</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">singularise_rang</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>rang</dt>
<dd><p>output from <code><a href="resolve.html">resolve()</a></code></p></dd>


<dt>output_dir</dt>
<dd><p>character, where to put the Apptainer/Singularity definition file and associated content</p></dd>


<dt>materials_dir</dt>
<dd><p>character, path to the directory containing additional resources (e.g. analysis scripts) to be copied into <code>output_dir</code> and in turn into the Apptainer/Singularity container</p></dd>


<dt>post_installation_steps</dt>
<dd><p>character, additional steps to be added before the in the end of <code>%post</code> section the Apptainer/Singularity definition file, see an example below</p></dd>


<dt>image</dt>
<dd><p>character, which versioned Rocker image to use. Can only be "r-ver", "rstudio", "tidyverse", "verse", "geospatial"
This applies only to R version &gt;= 3.1</p></dd>


<dt>rang_as_comment</dt>
<dd><p>logical, whether to write resolved result and the steps to reproduce
the file to <code>path</code> as comment</p></dd>


<dt>cache</dt>
<dd><p>logical, whether to cache the packages now. Please note that the system requirements are not cached. For query with non-CRAN packages, this option is strongly recommended. For query with local packages, this must be TRUE regardless of R version. For R version &lt; 3.1, this must be also TRUE if there is any non-CRAN packages.</p></dd>


<dt>verbose</dt>
<dd><p>logical, pass to <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>, the negated value is also passed as <code>quiet</code> to both <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>
and <code><a href="https://rdrr.io/r/utils/download.file.html" class="external-link">download.file()</a></code>.</p></dd>


<dt>lib</dt>
<dd><p>character, pass to <code><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages()</a></code>. By default, it is NA (to install the packages to the default location)</p></dd>


<dt>cran_mirror</dt>
<dd><p>character, which CRAN mirror to use</p></dd>


<dt>check_cran_mirror</dt>
<dd><p>logical, whether to check the CRAN mirror</p></dd>


<dt>bioc_mirror</dt>
<dd><p>character, which Bioconductor mirror to use</p></dd>


<dt>no_rocker</dt>
<dd><p>logical, whether to skip using Rocker images even when an appropriate version is available. Please keep this as <code>FALSE</code> unless you know what you are doing</p></dd>


<dt>debian_version</dt>
<dd><p>when Rocker images are not used, which EOL version of Debian to use. Can only be "lenny", "etch", "squeeze", "wheezy", "jessie", "stretch". Please keep this as default "lenny" unless you know what you are doing</p></dd>


<dt>skip_r17</dt>
<dd><p>logical, whether to skip R 1.7.x. Currently, it is not possible to compile R 1.7.x (R 1.7.0 and R 1.7.1) with the method provided by  <code>rang</code>. It affects <code>snapshot_date</code> from 2003-04-16 to 2003-10-07. When <code>skip_r17</code> is TRUE and <code>snapshot_date</code> is within the aforementioned range, R 1.8.0 is used instead</p></dd>


<dt>insert_readme</dt>
<dd><p>logical, whether to insert a README file</p></dd>


<dt>copy_all</dt>
<dd><p>logical, whether to copy everything in the current directory into the container. If <code>inst/rang</code> is detected in <code>output_dir</code>, this is coerced to TRUE.</p></dd>


<dt>method</dt>
<dd><p>character, can only be "auto", "evercran", "rocker", or "debian". Select which base image is used. "auto" (the default) selects the best option based on the R version. "evercran" is experimental.</p></dd>


<dt>...</dt>
<dd><p>arguments to be passed to <code>apptainerize</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p><code>output_dir</code>, invisibly</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The idea behind this is to determine the installation order of R packages locally. Then, the installation script can be deployed to another
fresh R session to install R packages. <code><a href="dockerize.html">dockerize()</a></code> and <code>apptainerize()</code> are more reasonable ways because a fresh R session with all system requirements
is provided.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><a href="https://apptainer.org/" class="external-link">Apptainer / Singularity</a></p>
<p>Kurtzer, G. M., Sochat, V., &amp; Bauer, M. W. (2017) Singularity: Scientific containers for mobility of compute. PLOS ONE, 12(5):e0177459. <a href="https://doi.org/10.1371/journal.pone.0177459" class="external-link">doi:10.1371/journal.pone.0177459</a></p>
<p><a href="https://rocker-project.org" class="external-link">The Rocker Project</a></p>
<p>Ripley, B. (2005) <a href="https://cran.r-project.org/doc/Rnews/Rnews_2005-1.pdf" class="external-link">Packages and their Management in R 2.1.0.</a> R News, 5(1):8--11.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="resolve.html">resolve()</a></code>, <code><a href="export_rang.html">export_rang()</a></code>, <code><a href="use_rang.html">use_rang()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="resolve.html">resolve</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        pkgs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"openNLP"</span>, <span class="st">"LDAvis"</span>, <span class="st">"topicmodels"</span>, <span class="st">"quanteda"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        snapshot_date <span class="op">=</span> <span class="st">"2020-01-16"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">apptainerize</span><span class="op">(</span><span class="va">graph</span>, <span class="st">"."</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="co">## An example of using post_installation_steps to install quarto</span></span></span>
<span class="r-in"><span>    <span class="va">install_quarto</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"apt-get install -y curl git &amp;&amp; \\</span></span></span>
<span class="r-in"><span><span class="st">    curl -LO https://quarto.org/download/latest/quarto-linux-amd64.deb &amp;&amp; \\</span></span></span>
<span class="r-in"><span><span class="st">    dpkg -i quarto-linux-amd64.deb &amp;&amp; \\</span></span></span>
<span class="r-in"><span><span class="st">    quarto install tool tinytex"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="fu">apptainerize</span><span class="op">(</span><span class="va">graph</span>, <span class="st">"."</span>, post_installation_steps <span class="op">=</span> <span class="va">install_quarto</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Maintained by <a href="https://github.com/gesistsa" class="external-link"><img alt="TSA Team" src="https://raw.githubusercontent.com/gesistsa/.github/main/tsa_logo.png" width="20"> Transparent Social Analytics Team, GESIS</a></p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Developed by <a href="http://www.chainsawriot.com" class="external-link">Chung-hong Chan</a>, <a href="https://mr.schochastics.net" class="external-link">David Schoch</a>.</p>
</div>

    </footer></div>

  

  

  </body></html>

